
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="JAX implementation of Model Predictive Path Integral (MPPI) control">
      
      
      
        <link rel="canonical" href="https://riccardo-enr.github.io/jax_mppi/plan/completed/porting_pytorch_jax/">
      
      
        <link rel="prev" href="../../quadrotor_trajectory_following/">
      
      
        <link rel="next" href="../evosax_integration/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Porting Plan - jax_mppi</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jax-mppi-implementation-plan" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="jax_mppi" class="md-header__button md-logo" aria-label="jax_mppi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jax_mppi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Porting Plan
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/riccardo-enr/jax_mppi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    jax_mppi
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="jax_mppi" class="md-nav__button md-logo" aria-label="jax_mppi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    jax_mppi
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/riccardo-enr/jax_mppi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    jax_mppi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Theory
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autotuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autotuning Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/mppi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mppi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/smppi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    smppi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/kmppi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kmppi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/autotune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    autotune
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/autotune_global/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    autotune_global
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/autotune_qd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    autotune_qd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/pendulum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pendulum
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quadrotor_trajectory_following/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quadrotor Trajectory Following Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" checked>
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Completed Plans
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Completed Plans
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Porting Plan
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Porting Plan
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#status-jan-31-2026" class="md-nav__link">
    <span class="md-ellipsis">
      
        Status (Jan 31, 2026)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Status (Jan 31, 2026)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation-status-by-phase" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Status by Phase
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#package-size-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Package Size Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-parity-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature Parity Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current File Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommended Next Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Design Decisions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Design Decisions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-style-functional-with-dataclass-state-containers" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Style: Functional with dataclass state containers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-jax-mappings-from-pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key JAX mappings from PyTorch
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes-from-pytorch_mppi-review-jan-2026" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes from ../pytorch_mppi review (Jan 2026)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#package-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Package Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phased-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phased Implementation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phased Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-project-scaffolding-core-mppi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: Project scaffolding + Core MPPI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-pendulum-example-integration-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Pendulum example (integration test)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-smooth-mppi-smppi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Smooth MPPI (SMPPI)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-kernel-mppi-kmppi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Kernel MPPI (KMPPI)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-smooth-comparison-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 5: Smooth comparison example
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-6-autotuning-stretch-goal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 6: Autotuning (stretch goal)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification Strategy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-setup-options-src-layout" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test setup options (src layout)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actionable-task-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Actionable Task Checklist
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Actionable Task Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-mppi-phase-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core MPPI (Phase 1)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smppi-phase-3" class="md-nav__link">
    <span class="md-ellipsis">
      
        SMPPI (Phase 3)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmppi-phase-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        KMPPI (Phase 4)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autotune-examples-phase-6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autotune + Examples (Phase 6)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evosax_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evosax Integration Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../releasing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Releasing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#status-jan-31-2026" class="md-nav__link">
    <span class="md-ellipsis">
      
        Status (Jan 31, 2026)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Status (Jan 31, 2026)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation-status-by-phase" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Status by Phase
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#package-size-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Package Size Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-parity-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature Parity Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current File Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommended Next Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Design Decisions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Design Decisions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-style-functional-with-dataclass-state-containers" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Style: Functional with dataclass state containers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-jax-mappings-from-pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key JAX mappings from PyTorch
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes-from-pytorch_mppi-review-jan-2026" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes from ../pytorch_mppi review (Jan 2026)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#package-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Package Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phased-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phased Implementation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phased Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-project-scaffolding-core-mppi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: Project scaffolding + Core MPPI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-pendulum-example-integration-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Pendulum example (integration test)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-smooth-mppi-smppi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Smooth MPPI (SMPPI)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-kernel-mppi-kmppi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Kernel MPPI (KMPPI)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-smooth-comparison-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 5: Smooth comparison example
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-6-autotuning-stretch-goal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 6: Autotuning (stretch goal)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification Strategy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-setup-options-src-layout" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test setup options (src layout)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actionable-task-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Actionable Task Checklist
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Actionable Task Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-mppi-phase-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core MPPI (Phase 1)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smppi-phase-3" class="md-nav__link">
    <span class="md-ellipsis">
      
        SMPPI (Phase 3)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmppi-phase-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        KMPPI (Phase 4)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autotune-examples-phase-6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autotune + Examples (Phase 6)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="jax-mppi-implementation-plan">JAX MPPI Implementation Plan</h1>
<p>Port <code>pytorch_mppi</code> to JAX, producing a functional, JIT-compilable MPPI library.</p>
<h2 id="status-jan-31-2026">Status (Jan 31, 2026)</h2>
<p><strong>Overall Progress:</strong> Phase 6 complete (Autotuning system fully implemented with CMA-ES, Ray Tune, and CMA-ME support).</p>
<h3 id="implementation-status-by-phase">Implementation Status by Phase</h3>
<ul>
<li><strong>Phase 1: Core MPPI</strong> âœ… <strong>COMPLETE</strong></li>
<li>353 lines implemented in <code>src/jax_mppi/mppi.py</code></li>
<li>All core features from pytorch_mppi ported</li>
<li>
<p>115 lines of unit tests in <code>tests/test_mppi.py</code></p>
</li>
<li>
<p><strong>Phase 2: Pendulum Integration</strong> âœ… <strong>COMPLETE</strong></p>
</li>
<li>270 lines in <code>examples/pendulum.py</code> (full-featured example with CLI)</li>
<li>282 lines in <code>tests/test_pendulum.py</code> (8 comprehensive integration tests)</li>
<li>
<p>All tests passing, swing-up and stabilization verified</p>
</li>
<li>
<p><strong>Phase 3: Smooth MPPI (SMPPI)</strong> âœ… <strong>COMPLETE</strong></p>
</li>
<li>634 lines implemented in <code>src/jax_mppi/smppi.py</code></li>
<li>All SMPPI features: action_sequence, smoothness cost, dual bounds, integration</li>
<li>580 lines in <code>tests/test_smppi.py</code> (18 comprehensive tests)</li>
<li>
<p>All tests passing</p>
</li>
<li>
<p><strong>Phase 4: Kernel MPPI (KMPPI)</strong> âœ… <strong>COMPLETE</strong></p>
</li>
<li>660 lines implemented in <code>src/jax_mppi/kmppi.py</code></li>
<li>RBFKernel, kernel interpolation, control point optimization</li>
<li>595 lines in <code>tests/test_kmppi.py</code> (23 comprehensive tests)</li>
<li>
<p>All tests passing (53/53 total tests pass)</p>
</li>
<li>
<p><strong>Phase 5: Smooth Comparison Example</strong> âœ… <strong>COMPLETE</strong></p>
</li>
<li>442 lines in <code>examples/smooth_comparison.py</code></li>
<li>Compares MPPI, SMPPI, and KMPPI on 2D navigation with obstacle avoidance</li>
<li>Includes visualization with 4 subplots: trajectories, costs, controls, smoothness</li>
<li>
<p>Supporting modules: <code>src/jax_mppi/costs/</code> and <code>src/jax_mppi/dynamics/</code></p>
</li>
<li>
<p><strong>Phase 6: Autotuning</strong> âœ… <strong>COMPLETE</strong></p>
</li>
<li>656 lines in <code>src/jax_mppi/autotune.py</code> - Core CMA-ES autotuning</li>
<li>375 lines in <code>src/jax_mppi/autotune_global.py</code> - Ray Tune global search</li>
<li>218 lines in <code>src/jax_mppi/autotune_qd.py</code> - CMA-ME quality diversity</li>
<li>305 lines in <code>tests/test_autotune.py</code> (21 unit tests)</li>
<li>247 lines in <code>tests/test_autotune_integration.py</code> (4 integration tests)</li>
<li>321 lines in <code>examples/autotune_pendulum.py</code> - Full demonstration</li>
<li>90 lines in <code>examples/autotune_basic.py</code> - Minimal example</li>
<li>All 25 tests passing</li>
</ul>
<h3 id="package-size-comparison">Package Size Comparison</h3>
<table>
<thead>
<tr>
<th>Package</th>
<th>Core Code</th>
<th>Tests</th>
<th>Examples</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>pytorch_mppi</strong></td>
<td>1214 lines</td>
<td>~500 lines</td>
<td>~800 lines</td>
<td>~2500 lines</td>
</tr>
<tr>
<td><strong>jax_mppi</strong> (current)</td>
<td>2919 lines</td>
<td>2124 lines</td>
<td>681 lines</td>
<td><strong>5724 lines</strong></td>
</tr>
<tr>
<td><strong>Completion %</strong></td>
<td>240%</td>
<td>425%</td>
<td>85%</td>
<td><strong>229%</strong></td>
</tr>
</tbody>
</table>
<p>Core code now includes: mppi.py (353), smppi.py (634), kmppi.py (660), autotune.py (656), autotune_global.py (375), autotune_qd.py (218), plus supporting modules.</p>
<h3 id="feature-parity-matrix">Feature Parity Matrix</h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Feature</th>
<th style="text-align: left;">pytorch_mppi</th>
<th style="text-align: left;">jax_mppi</th>
<th style="text-align: left;">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Core MPPI Algorithm</strong></td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">Basic sampling &amp; weighting</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Control bounds (u_min/u_max)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Control scaling (u_scale)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Partial updates (u_per_command)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Step-dependent dynamics</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Stochastic dynamics (rollout_samples)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Sample null action</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Noise absolute cost</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Terminal cost function</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Shift nominal trajectory</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Get rollouts (visualization)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Reset controller</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Smooth MPPI (SMPPI)</strong></td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">Action sequence tracking</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Smoothness penalty</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Separate action/control bounds</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Delta_t integration</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Shift with continuity</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Kernel MPPI (KMPPI)</strong></td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">Kernel interpolation</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">RBF kernel</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Support point optimization</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Time grid management (Tk/Hs)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Solve-based interpolation</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Autotuning</strong></td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">CMA-ES local tuning</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Ray Tune global search</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">CMA-ME quality diversity</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">Parameter types (lambda, sigma, mu, horizon)</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;">All MPPI variants support</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ…</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Examples</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Pendulum swing-up</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">Smooth MPPI comparison</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">Autotuning example</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ… Complete</td>
</tr>
<tr>
<td style="text-align: left;">Pendulum with learned dynamics</td>
<td style="text-align: left;">âœ“</td>
<td style="text-align: left;">âœ—</td>
<td style="text-align: left;">ðŸ”´ Not planned</td>
</tr>
</tbody>
</table>
<h3 id="current-file-structure">Current File Structure</h3>
<pre><code class="language-text">jax_mppi/
â”œâ”€â”€ pyproject.toml              âœ… Exists
â”œâ”€â”€ README.md                   âœ… Exists
â”œâ”€â”€ LICENSE                     âœ… Exists  
â”œâ”€â”€ src/jax_mppi/
â”‚   â”œâ”€â”€ __init__.py            âœ… Exists (updated for autotune)
â”‚   â”œâ”€â”€ types.py               âœ… Exists (9 lines)
â”‚   â”œâ”€â”€ mppi.py                âœ… Exists (353 lines) - COMPLETE
â”‚   â”œâ”€â”€ smppi.py               âœ… Exists (634 lines) - COMPLETE
â”‚   â”œâ”€â”€ kmppi.py               âœ… Exists (660 lines) - COMPLETE
â”‚   â”œâ”€â”€ autotune.py            âœ… Exists (656 lines) - COMPLETE
â”‚   â”œâ”€â”€ autotune_global.py     âœ… Exists (375 lines) - COMPLETE
â”‚   â”œâ”€â”€ autotune_qd.py         âœ… Exists (218 lines) - COMPLETE
â”‚   â”œâ”€â”€ costs/                 âœ… Exists (supporting modules)
â”‚   â””â”€â”€ dynamics/              âœ… Exists (supporting modules)
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_mppi.py           âœ… Exists (115 lines) - COMPLETE
â”‚   â”œâ”€â”€ test_pendulum.py       âœ… Exists (282 lines) - COMPLETE
â”‚   â”œâ”€â”€ test_smppi.py          âœ… Exists (580 lines) - COMPLETE
â”‚   â”œâ”€â”€ test_autotune.py       âœ… Exists (305 lines, 21 tests) - COMPLETE
â”‚   â””â”€â”€ test_autotune_integration.py âœ… Exists (247 lines, 4 tests) - COMPLETE
â”‚   â””â”€â”€ test_kmppi.py          âœ… Exists (595 lines) - COMPLETE
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ pendulum.py            âœ… Exists (270 lines) - COMPLETE
â”‚   â”œâ”€â”€ smooth_comparison.py   âœ… Exists (442 lines) - COMPLETE
â”‚   â”œâ”€â”€ autotune_pendulum.py   âœ… Exists (321 lines) - COMPLETE
â”‚   â””â”€â”€ autotune_basic.py      âœ… Exists (90 lines) - COMPLETE
â””â”€â”€ docs/
    â””â”€â”€ plan/
        â””â”€â”€ porting_pytorch_jax.md âœ… This file
</code></pre>
<h3 id="recommended-next-steps">Recommended Next Steps</h3>
<p><strong>Priority Order:</strong></p>
<ol>
<li><strong>Phase 3: SMPPI Implementation</strong> (High Priority)</li>
<li>Core functionality that adds smoothness to control</li>
<li>Estimated ~250-300 lines for smppi.py</li>
<li>Estimated ~150-200 lines for tests</li>
<li>
<p>Reference: <code>../pytorch_mppi/src/pytorch_mppi/mppi.py</code> (SMPPI class)</p>
</li>
<li>
<p><strong>Phase 4: KMPPI Implementation</strong> (High Priority)</p>
</li>
<li>Novel contribution with kernel interpolation</li>
<li>Estimated ~300-350 lines for kmppi.py</li>
<li>Estimated ~150-200 lines for tests</li>
<li>
<p>Reference: <code>../pytorch_mppi/src/pytorch_mppi/mppi.py</code> (KMPPI class)</p>
</li>
<li>
<p><strong>Phase 5: Smooth Comparison Example</strong> (Medium Priority)</p>
</li>
<li>Demonstrates value of SMPPI and KMPPI</li>
<li>Estimated ~200-250 lines</li>
<li>
<p>Reference: <code>../pytorch_mppi/tests/smooth_mppi.py</code></p>
</li>
<li>
<p><strong>Additional Examples</strong> (Low Priority)</p>
</li>
<li>Pendulum with learned dynamics</li>
<li>
<p>More complex environments</p>
</li>
<li>
<p><strong>Phase 6: Autotuning</strong> (Optional/Stretch)</p>
</li>
<li>Advanced feature for hyperparameter optimization</li>
<li>Estimated ~300-400 lines</li>
<li>Reference: <code>../pytorch_mppi/src/pytorch_mppi/autotune.py</code></li>
</ol>
<h2 id="design-decisions">Design Decisions</h2>
<h3 id="api-style-functional-with-dataclass-state-containers">API Style: Functional with dataclass state containers</h3>
<p>Use <code>@jax.tree_util.register_dataclass</code> (or <code>flax.struct.dataclass</code>) to hold MPPI state (nominal trajectory <code>U</code>, PRNG key, config). All core functions are pure: <code>command(state, mppi_state) -&gt; (action, mppi_state)</code>.</p>
<p><strong>Rationale:</strong> Idiomatic JAX â€” pure functions compose with <code>jit</code>, <code>vmap</code>, <code>grad</code>. No mutable <code>self</code>. Avoids heavyweight dependencies like Equinox for what is fundamentally a numerical algorithm.</p>
<h3 id="key-jax-mappings-from-pytorch">Key JAX mappings from PyTorch</h3>
<table>
<thead>
<tr>
<th>PyTorch</th>
<th>JAX</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>torch.distributions.MultivariateNormal</code></td>
<td><code>jax.random.multivariate_normal</code></td>
</tr>
<tr>
<td><code>tensor.to(device)</code></td>
<td><code>jax.device_put</code> / automatic</td>
</tr>
<tr>
<td>Python for-loop over horizon</td>
<td><code>jax.lax.scan</code></td>
</tr>
<tr>
<td><code>@handle_batch_input</code> decorator</td>
<td><code>jax.vmap</code></td>
</tr>
<tr>
<td><code>torch.roll</code></td>
<td><code>jnp.roll</code></td>
</tr>
<tr>
<td><code>torch.linalg.solve</code></td>
<td><code>jnp.linalg.solve</code></td>
</tr>
<tr>
<td>In-place mutation (<code>self.U = ...</code>)</td>
<td>Return new state (pytree)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="notes-from-pytorch_mppi-review-jan-2026">Notes from <code>../pytorch_mppi</code> review (Jan 2026)</h2>
<p>Actionable parity items to carry over:</p>
<ul>
<li><strong>SMPPI semantics:</strong> maintains <code>action_sequence</code> separately from lifted control <code>U</code>; integrates with <code>delta_t</code>; smoothness cost from <code>diff(action_sequence)</code>.</li>
<li><strong>SMPPI bounds:</strong> support <code>action_min</code>/<code>action_max</code> distinct from <code>u_min</code>/<code>u_max</code> (control-derivative bounds).</li>
<li><strong>KMPPI internals:</strong> keep <code>theta</code> as control points; build <code>Tk</code>/<code>Hs</code> time grids; kernel interpolation via <code>solve(Ktktk, K)</code>; batch interpolation with <code>vmap</code>.</li>
<li><strong>Sampling options:</strong> <code>rollout_samples</code> (M), <code>sample_null_action</code>, <code>noise_abs_cost</code> (abs(noise) in action cost).</li>
<li><strong>Rollouts:</strong> <code>get_rollouts</code> handles <code>state</code> batch and dynamics that may augment state (take first <code>nx</code>).</li>
</ul>
<hr />
<h2 id="package-structure">Package Structure</h2>
<pre><code class="language-text">jax_mppi/
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ README.md
â”œâ”€â”€ LICENSE
â”œâ”€â”€ src/jax_mppi/
â”‚   â”œâ”€â”€ __init__.py          # Public API exports
â”‚   â”œâ”€â”€ mppi.py              # Core MPPI (MPPIConfig, MPPIState, command, reset, etc.)
â”‚   â”œâ”€â”€ smppi.py             # Smooth MPPI variant
â”‚   â”œâ”€â”€ kmppi.py             # Kernel MPPI variant + TimeKernel / RBFKernel
â”‚   â”œâ”€â”€ types.py             # Type aliases, protocols for Dynamics/Cost callables
â”‚   â””â”€â”€ autotune.py          # Autotuning (CMA-ES wrapper, parameter search)
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_mppi.py         # Unit tests for core MPPI
â”‚   â”œâ”€â”€ test_smppi.py        # Unit tests for SMPPI
â”‚   â”œâ”€â”€ test_kmppi.py        # Unit tests for KMPPI
â”‚   â””â”€â”€ test_pendulum.py     # Integration test with pendulum env
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ pendulum.py          # Gym pendulum with true dynamics
â”‚   â”œâ”€â”€ pendulum_approximate.py  # Learned dynamics
â”‚   â””â”€â”€ smooth_comparison.py # MPPI vs SMPPI vs KMPPI
â””â”€â”€ docs/
    â””â”€â”€ plan/
</code></pre>
<hr />
<h2 id="phased-implementation">Phased Implementation</h2>
<h3 id="phase-1-project-scaffolding-core-mppi">Phase 1: Project scaffolding + Core MPPI</h3>
<p><strong>Files:</strong> <code>pyproject.toml</code>, <code>src/jax_mppi/types.py</code>, <code>src/jax_mppi/mppi.py</code>, <code>src/jax_mppi/__init__.py</code></p>
<ol>
<li>
<p><strong><code>pyproject.toml</code></strong> â€” project metadata, deps: <code>jax[cuda13]</code>, <code>jaxlib</code>, optional <code>gymnasium</code> for examples.</p>
</li>
<li>
<p><strong><code>types.py</code></strong> â€” Type definitions:</p>
</li>
</ol>
<p><code>python
   # Dynamics: (state, action) -&gt; next_state  or  (state, action, t) -&gt; next_state
   DynamicsFn = Callable[..., jax.Array]
   # Cost: (state, action) -&gt; scalar_cost  or  (state, action, t) -&gt; scalar_cost
   RunningCostFn = Callable[..., jax.Array]
   # Terminal: (states, actions) -&gt; scalar_cost
   TerminalCostFn = Callable[[jax.Array, jax.Array], jax.Array]</code></p>
<ol>
<li><strong><code>mppi.py</code></strong> â€” Core implementation:</li>
</ol>
<p><strong>Data structures (registered as JAX pytrees):</strong></p>
<p>```python
   @dataclass
   class MPPIConfig:
       # Static config (not traced through JAX)
       num_samples: int       # K
       horizon: int           # T
       nx: int
       nu: int
       lambda_: float
       u_scale: float
       u_per_command: int
       step_dependent_dynamics: bool
       rollout_samples: int   # M
       rollout_var_cost: float
       rollout_var_discount: float
       sample_null_action: bool
       noise_abs_cost: bool</p>
<p>@dataclass
   class MPPIState:
       # Dynamic state (carried through JAX transforms)
       U: jax.Array           # (T, nu) nominal trajectory
       u_init: jax.Array      # (nu,) default action for shift
       noise_mu: jax.Array    # (nu,)
       noise_sigma: jax.Array # (nu, nu)
       noise_sigma_inv: jax.Array
       u_min: jax.Array | None
       u_max: jax.Array | None
       key: jax.Array         # PRNG key
   ```</p>
<p><strong>Functions:</strong></p>
<p>```python
   def create(
       nx, nu, noise_sigma, num_samples=100, horizon=15, lambda_=1.0,
       noise_mu=None, u_min=None, u_max=None, u_init=None, U_init=None,
       u_scale=1, u_per_command=1, step_dependent_dynamics=False,
       rollout_samples=1, rollout_var_cost=0., rollout_var_discount=0.95,
       sample_null_action=False, noise_abs_cost=False, key=None,
   ) -&gt; tuple[MPPIConfig, MPPIState]:
       """Factory: create config + initial state."""</p>
<p>def command(
       config: MPPIConfig,
       mppi_state: MPPIState,
       current_obs: jax.Array,
       dynamics: DynamicsFn,
       running_cost: RunningCostFn,
       terminal_cost: TerminalCostFn | None = None,
       shift: bool = True,
   ) -&gt; tuple[jax.Array, MPPIState]:
       """Compute optimal action and return updated state."""</p>
<p>def reset(config: MPPIConfig, mppi_state: MPPIState, key: jax.Array) -&gt; MPPIState:
       """Reset nominal trajectory."""</p>
<p>def get_rollouts(
       config: MPPIConfig, mppi_state: MPPIState,
       current_obs: jax.Array, dynamics: DynamicsFn,
       num_rollouts: int = 1,
   ) -&gt; jax.Array:
       """Forward-simulate trajectories for visualization."""
   ```</p>
<p><strong>Internal functions (all JIT-compatible):</strong>
   - <code>_shift_nominal(mppi_state) -&gt; MPPIState</code> â€” <code>jnp.roll</code> + set last to <code>u_init</code>
   - <code>_sample_noise(key, K, T, noise_mu, noise_sigma) -&gt; (noise, new_key)</code> â€” sample from multivariate normal
   - <code>_compute_rollout_costs(config, current_obs, perturbed_actions, dynamics, running_cost, terminal_cost)</code> â€” uses <code>jax.lax.scan</code> over horizon, <code>jax.vmap</code> over K samples
   - <code>_compute_weights(costs, lambda_)</code> â€” softmax importance weighting
   - <code>_bound_action(action, u_min, u_max)</code> â€” <code>jnp.clip</code></p>
<p><strong>Key JAX patterns:</strong>
   - Rollout loop: <code>jax.lax.scan</code> with carry = <code>(state,)</code>, xs = <code>actions[t]</code>
   - Batch over K samples: <code>jax.vmap(_single_rollout, in_axes=(0, None, ...))</code>
   - Batch over M rollout samples (stochastic dynamics): nested vmap or scan
   - All internal functions decorated with <code>@jax.jit</code> or called inside a top-level jitted <code>command</code></p>
<ol>
<li><strong>Unit test:</strong> <code>tests/test_mppi.py</code></li>
<li>Test <code>create()</code> produces valid config/state</li>
<li>Test <code>command()</code> returns correct shape</li>
<li>Test cost reduction over iterations on simple 1D problem</li>
<li>Test bounds are respected</li>
</ol>
<h3 id="phase-2-pendulum-example-integration-test">Phase 2: Pendulum example (integration test)</h3>
<p><strong>Files:</strong> <code>examples/pendulum.py</code>, <code>tests/test_pendulum.py</code></p>
<ol>
<li>Implement pendulum dynamics as a pure JAX function (no gym dependency for core test)</li>
<li>Run MPPI loop, verify convergence (swing-up or stabilization)</li>
<li>Optional: gym rendering wrapper for visualization</li>
</ol>
<h3 id="phase-3-smooth-mppi-smppi">Phase 3: Smooth MPPI (SMPPI)</h3>
<p><strong>Files:</strong> <code>src/jax_mppi/smppi.py</code>, <code>tests/test_smppi.py</code></p>
<ol>
<li><strong>Data structures:</strong></li>
</ol>
<p><code>python
   @dataclass
   class SMPPIState(MPPIState):
       action_sequence: jax.Array  # (T, nu) actual actions
       w_action_seq_cost: float
       delta_t: float
       action_min: jax.Array | None
       action_max: jax.Array | None</code></p>
<ol>
<li><strong>Functions:</strong> Same API as <code>mppi.py</code> but with:</li>
<li><code>_shift_nominal</code> shifts both <code>U</code> (velocity) and <code>action_sequence</code></li>
<li><code>_compute_perturbed_actions</code> integrates velocity to get actions</li>
<li><code>_compute_total_cost</code> adds smoothness penalty: <code>||diff(actions)||^2</code></li>
<li><code>reset()</code> zeros both <code>U</code> and <code>action_sequence</code></li>
<li>
<p><code>change_horizon()</code> keeps both <code>U</code> and <code>action_sequence</code> in sync (truncate/extend)</p>
</li>
<li>
<p><strong>Test:</strong> Verify smoother trajectories than base MPPI on 2D navigation</p>
</li>
</ol>
<h3 id="phase-4-kernel-mppi-kmppi">Phase 4: Kernel MPPI (KMPPI)</h3>
<p><strong>Files:</strong> <code>src/jax_mppi/kmppi.py</code>, <code>tests/test_kmppi.py</code></p>
<ol>
<li><strong>Kernel abstractions:</strong></li>
</ol>
<p>```python
   def rbf_kernel(t, tk, sigma=1.0):
       d = jnp.sum((t[:, None] - tk) ** 2, axis=-1)
       return jnp.exp(-d / (2 * sigma ** 2 + 1e-8))</p>
<p>def kernel_interpolate(t, tk, coeffs, kernel_fn):
       K_t_tk = kernel_fn(t, tk)
       K_tk_tk = kernel_fn(tk, tk)
       weights = jnp.linalg.solve(K_tk_tk, K_t_tk.T).T
       return weights @ coeffs
   ```</p>
<ol>
<li><strong>Data structures:</strong></li>
</ol>
<p><code>python
   @dataclass
   class KMPPIState(MPPIState):
       theta: jax.Array         # (num_support_pts, nu)
       num_support_pts: int</code></p>
<ol>
<li><strong>Functions:</strong> Override <code>_compute_perturbed_actions</code> to sample sparse + interpolate. Update <code>theta</code> instead of <code>U</code>.</li>
<li>Build <code>Tk</code> and <code>Hs</code> time grids on init and on horizon changes</li>
<li>Use <code>kernel_interpolate()</code> with <code>solve(Ktktk, K)</code> (avoid explicit inverse)</li>
<li>
<p>Batch interpolate with <code>jax.vmap</code> for K samples</p>
</li>
<li>
<p><strong>Test:</strong> Verify fewer parameters produce smooth trajectories</p>
</li>
</ol>
<h3 id="phase-5-smooth-comparison-example">Phase 5: Smooth comparison example</h3>
<p><strong>Files:</strong> <code>examples/smooth_comparison.py</code></p>
<ul>
<li>Side-by-side MPPI vs SMPPI vs KMPPI on 2D navigation</li>
<li>Plot trajectories and control signals</li>
</ul>
<h3 id="phase-6-autotuning-stretch-goal">Phase 6: Autotuning (stretch goal)</h3>
<p><strong>Files:</strong> <code>src/jax_mppi/autotune.py</code></p>
<ul>
<li>Wrap CMA-ES (<code>cmaes</code> or <code>evosax</code> for JAX-native) for sigma/lambda/horizon tuning</li>
<li>Simpler than pytorch_mppi's framework â€” skip Ray Tune and QD initially</li>
<li>Functional API: <code>tune_step(eval_fn, params, optimizer_state) -&gt; (params, optimizer_state)</code></li>
</ul>
<hr />
<h2 id="verification-strategy">Verification Strategy</h2>
<ol>
<li><strong>Unit tests (per phase):</strong> <code>pytest tests/</code> â€” shape checks, cost reduction, bounds</li>
<li><strong>Pendulum benchmark:</strong> Compare convergence (total reward) against pytorch_mppi on same scenario</li>
<li><strong>JIT correctness:</strong> Ensure <code>jax.jit(command)</code> produces identical results to non-jitted version</li>
<li><strong>Performance:</strong> Benchmark <code>command()</code> latency vs pytorch_mppi (JAX should win after warmup due to XLA compilation)</li>
<li><strong>Smooth variants:</strong> Visual comparison of trajectory smoothness</li>
</ol>
<h3 id="test-setup-options-src-layout">Test setup options (src layout)</h3>
<p>IMPORTANT: You should always use the virtual environment. To run the tests and all of the other python files.</p>
<ul>
<li>Option A: add a <code>tests/conftest.py</code> to insert <code>src</code> into <code>sys.path</code>.</li>
<li>Option B: run tests after <code>uv pip install -e .</code> (editable install).</li>
</ul>
<h2 id="dependencies">Dependencies</h2>
<p><strong>Core:</strong> <code>jax[cuda13]</code>, <code>jaxlib</code>, <code>numpy</code>
<strong>Testing:</strong> <code>pytest</code>, <code>gymnasium[classic_control]</code>
<strong>Autotuning (optional):</strong> <code>cmaes</code> or <code>evosax</code>
<strong>Examples (optional):</strong> <code>matplotlib</code>, <code>gymnasium</code></p>
<hr />
<h2 id="actionable-task-checklist">Actionable Task Checklist</h2>
<h3 id="core-mppi-phase-1">Core MPPI (Phase 1)</h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Mirror <code>pytorch_mppi</code> signature flags: <code>rollout_samples</code>, <code>sample_null_action</code>, <code>noise_abs_cost</code>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement <code>get_rollouts</code> handling: accept single or batched <code>state</code>; allow dynamics that augment state (take <code>:nx</code>).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Add <code>shift_nominal_trajectory</code> via <code>jnp.roll</code> + <code>u_init</code> fill.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement action cost with optional <code>abs(noise)</code> branch.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Add <code>u_per_command</code> slicing and <code>u_scale</code> application in <code>command</code>.</li>
</ul>
<h3 id="smppi-phase-3">SMPPI (Phase 3)</h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Carry <code>action_sequence</code> in state and integrate <code>U</code> with <code>delta_t</code>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement distinct action bounds (<code>action_min</code>/<code>action_max</code>) vs control bounds (<code>u_min</code>/<code>u_max</code>).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Add smoothness cost from <code>diff(action_sequence)</code> and weight <code>w_action_seq_cost</code>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Ensure <code>reset()</code> updates both <code>U</code> and <code>action_sequence</code>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement proper shift with action continuity (hold last value).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement dual bounding system (_bound_control and _bound_action).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Recompute effective noise after bounding for accurate cost.</li>
</ul>
<h3 id="kmppi-phase-4">KMPPI (Phase 4)</h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement <code>theta</code> control points + interpolation kernel (RBF by default).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Build <code>Tk</code>/<code>Hs</code> grids and re-build on horizon changes.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Use <code>solve(Ktktk, K)</code> for interpolation weights (no explicit inverse).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Shift <code>theta</code> via interpolation when shifting nominal trajectory.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Implement RBFKernel with configurable sigma.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Noise sampling in control point space.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Batched interpolation with vmap.</li>
</ul>
<h3 id="autotune-examples-phase-6">Autotune + Examples (Phase 6)</h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Mirror autotune interface from <code>pytorch_mppi/autotune*.py</code> at a minimal level (evaluation fn + optimizer loop).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Port <code>tests/auto_tune_parameters.py</code> logic into a JAX-friendly example.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.sections", "navigation.expand", "navigation.top"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>